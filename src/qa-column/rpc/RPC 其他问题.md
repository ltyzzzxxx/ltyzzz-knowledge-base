---
title: RPC 其他问题
---

## 问题清单

::: tip Questions
1.   **你认为 RPC 项目设计最亮眼的地方是什么？**

2.   **是否有投入到实际生产环境中？是否有尝试做过压力测试？**
::: 

## 问题回答

1.   **你认为 RPC 项目设计最亮眼的地方是什么？**
::: info Answer
  除了常规 RPC 项目必备的代理层、路由层、注册中心层、容错层等

  -   使用了异步设计，对各个操作进行解耦

      -   对于服务端：

          当请求抵达服务器时，将其直接丢入业务阻塞队列中，然后开辟一个新的线程，从阻塞队列中循环获取Handler请求任务。

          将获取到的任务对象交付于业务线程池进行消费处理。

      -   对于客户端：

          在 `RpcReferenceWrapper` 中设置一个 `isAsync` 字段，用于判断是否为异步。

          若该字段为 `True`，则在动态代理层中，不需要同步阻塞等待响应结果，直接返回 `null` 即可

  -   仿照 Dubbo 设计方式，引入 `@IRpcReference` 与  `@IRpcService`   注解，并将项目接入 SpringBoot。
:::

2.   **是否有投入到实际生产环境中？是否有尝试做过压力测试？**
::: info Answer
  通过设置连续请求次数为 100 / 1000 / 10000，对框架进行压力测试，发现随着请求次数梯度上升，整体接口的响应速度和结果并没有发生变化。说明框架稳定

  关于线程池线程数的选择

  >   根据线程池处理任务的类型进行选择
  >
  >   -   如果是CPU密集型任务，如：加密、解密、压缩、计算，应该根据当前服务器CPU核心数进行选择，最好是CPU核心数的1~2倍
  >
  >   -   如果是IO密集型任务，如：数据库、网络传输、文件读写，应该尽可能提升线程数
  >
  >   -   公式为：线程数 = CPU 核心数 *（1+平均等待时间/平均工作时间）
  >
  >       -   平均等待时间越长，说明是IO密集型，需要增大线程数
  >
  >       -   平均工作时间越长，说明是CPU密集型，需要减少线程数
:::